{"version":3,"file":"clipsDataStoreUtils.js","sourceRoot":"","sources":["../../../src/utils/clipsDataStoreUtils.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,4CAA0C;AAC1C,8CAA+C;AAC/C,qEAAkE;AAClE,kDAAoC;AACpC,2DAA6C;AAE7C,MAAM,QAAQ,GAAG,IAAI,iCAAe,CAAC;IACjC,MAAM,EAAE,sBAAU;IAClB,OAAO,EAAE,oBAAO,CAAC,GAAG;CACvB,CAAC,CAAC;AAEI,MAAM,UAAU,GAAG,KAAK,EAC3B,IAAW,EACX,QAAgB,EACF,EAAE;IAChB,MAAM,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IAC5B,OAAO,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC;AAC5E,CAAC,CAAC;AANW,QAAA,UAAU,cAMrB;AAEK,MAAM,UAAU,GAAG,KAAK,EAC3B,IAAW,EACX,QAAgB,EAChB,SAAiB,EACH,EAAE;IAChB,MAAM,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IACzB,MAAM,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;IACtD,OAAO,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC;AAC3D,CAAC,CAAC;AARW,QAAA,UAAU,cAQrB;AAEK,MAAM,QAAQ,GAAG,KAAK,EACzB,IAAW,EACX,QAAgB,EAChB,eAA8B,IAAI,EACpB,EAAE;IAChB,IAAI,SAAS,GAAG,WAAW,CAAC,kBAAkB,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;IACtE,IAAI,YAAY,EAAE;QACd,SAAS,GAAG,WAAW,CAAC,eAAe,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;KACpE;IACD,MAAM,OAAO,GAAG;QACZ,GAAG,IAAI;QACP,MAAM,EAAE,SAAS;KACpB,CAAC;IACF,MAAM,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;IAC5B,OAAO,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,CAAC;AACzE,CAAC,CAAC;AAfW,QAAA,QAAQ,YAenB;AAEK,MAAM,UAAU,GAAG,KAAK,EAAE,IAAW,EAAE,EAAE;IAC5C,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;IAC1C,OAAO,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AAC5C,CAAC,CAAC;AAHW,QAAA,UAAU,cAGrB","sourcesContent":["import { AWS_REGION } from '../constants';\nimport { EnvName, IClip } from '../interfaces';\nimport { ClipsRepository } from '../repositories/clipsRepository';\nimport * as s3Util from './s3Utils';\nimport * as s3PathUtils from './s3PathUtils';\n\nconst clipRepo = new ClipsRepository({\n    region: AWS_REGION,\n    envName: EnvName.DEV,\n});\n\nexport const createClip = async (\n    clip: IClip,\n    filePath: string\n): Promise<IClip> => {\n    await clipRepo.create(clip);\n    return s3Util.putObjectFromFile(clip.s3Path, filePath).then(() => clip);\n};\n\nexport const updateClip = async (\n    clip: IClip,\n    filePath: string,\n    oldS3Path: string\n): Promise<IClip> => {\n    await clipRepo.put(clip);\n    await s3Util.putObjectFromFile(clip.s3Path, filePath);\n    return s3Util.deleteObject(oldS3Path).then(() => clip);\n};\n\nexport const moveClip = async (\n    clip: IClip,\n    toFolder: string,\n    parentFolder: string | null = null\n): Promise<IClip> => {\n    let newS3Path = s3PathUtils.updateS3PathFolder(toFolder, clip.s3Path);\n    if (parentFolder) {\n        newS3Path = s3PathUtils.addParentFolder(parentFolder, newS3Path);\n    }\n    const newClip = {\n        ...clip,\n        s3Path: newS3Path,\n    };\n    await clipRepo.put(newClip);\n    return s3Util.moveObject(clip.s3Path, newS3Path).then(() => newClip);\n};\n\nexport const deleteClip = async (clip: IClip) => {\n    clipRepo.delete(clip.gameName, clip.guid);\n    return s3Util.deleteObject(clip.s3Path);\n};\n"]}